implemented entity joins in services